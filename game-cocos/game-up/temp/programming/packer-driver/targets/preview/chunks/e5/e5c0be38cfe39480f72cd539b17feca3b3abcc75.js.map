{"version":3,"sources":["file:///Users/chenchao/code/person/game-upgradation/game-cocos/game-up/assets/iogame/HandleMgr.ts"],"names":["HandleMgr","hashFun","CmdMgr","LogUtils","init","addHandler","cmdMerge","handler","log","handlers","undefined","getHandler","funHash","console","error","getCmd","getSubCmd","packageHandler","data","msgId"],"mappings":";;;yDAOqBA,S;;;;;;;;;;;;;;;;;;;;;;;;;;AAPbC,MAAAA,O,iBAAAA,O;;AACDC,MAAAA,M;;AAEAC,MAAAA,Q;;;;;;;yBAIcH,S,GAAN,MAAMA,SAAN,CAAgB;AAKT,eAAJI,IAAI,GAAS,CAC1B;AAED;;;AACwB,eAAVC,UAAU,CAACC,QAAD,EAAmBC,OAAnB,EAA4C;AAChE;AAAA;AAAA,oCAASC,GAAT,CAAa,KAAb,EAAuBF,QAAvB,SAAmC;AAAA;AAAA,kCAAQC,OAAR,CAAnC;AACA,cAAIP,SAAS,CAACS,QAAV,CAAsBH,QAAtB,SAAkC;AAAA;AAAA,kCAAQC,OAAR,CAAlC,KAAyDG,SAA7D,EACIV,SAAS,CAACS,QAAV,CAAsBH,QAAtB,SAAkC;AAAA;AAAA,kCAAQC,OAAR,CAAlC,IAAwDA,OAAxD;AACP;AAGD;;;AACwB,eAAVI,UAAU,CAACL,QAAD,EAAmBM,OAAnB,EAA8C;AAClE,cAAIL,OAAJ;AACA,cAAIP,SAAS,CAACS,QAAV,CAAsBH,QAAtB,SAAkCM,OAAlC,CAAJ,EACIL,OAAO,GAAGP,SAAS,CAACS,QAAV,CAAsBH,QAAtB,SAAkCM,OAAlC,CAAV;;AACJ,cAAIL,OAAO,IAAI,IAAf,EAAqB;AACjBM,YAAAA,OAAO,CAACC,KAAR,CAAc,+BAAd,EAA+C;AAAA;AAAA,kCAAOC,MAAP,CAAcT,QAAd,CAA/C,EAAwE;AAAA;AAAA,kCAAOU,SAAP,CAAiBV,QAAjB,CAAxE,EAAoGM,OAApG;AACH;;AACD,iBAAOL,OAAP;AACH,SAzB0B,CA2B3B;;;AAC4B,eAAdU,cAAc,CAACX,QAAD,EAAmBY,IAAnB,EAA0C;AAClE,cAAIX,OAAO,GAAG,KAAKI,UAAL,CAAgBL,QAAhB,EAA0BY,IAAI,CAACC,KAA/B,CAAd;AACA,cAAIZ,OAAJ,EACIA,OAAO,CAACW,IAAD,CAAP;AACP;;AAhC0B,O;;AAAVlB,MAAAA,S,CAGFS,Q,GAAmB,E","sourcesContent":["import {hashFun} from \"db://assets/iogame/HashUtils\";\nimport CmdMgr from \"db://assets/iogame/cmd/CmdMgr\";\nimport {ExternalMessage} from \"db://assets/iogame/pb/ExternalMessage\";\nimport LogUtils from \"db://assets/iogame/LogUtils\";\n\ntype Mapper = Record<string, Function>\n\nexport default class HandleMgr {\n\n\n    private static handlers: Mapper = {};\n\n    public static init(): void {\n    }\n\n    /**注册回调*/\n    public static addHandler(cmdMerge: number, handler: Function): void {\n        LogUtils.log('add', `${cmdMerge}_${hashFun(handler)}`)\n        if (HandleMgr.handlers[`${cmdMerge}_${hashFun(handler)}`] == undefined)\n            HandleMgr.handlers[`${cmdMerge}_${hashFun(handler)}`] = handler\n    }\n\n\n    /**获取回调接口*/\n    public static getHandler(cmdMerge: number, funHash: number): Function {\n        var handler: Function;\n        if (HandleMgr.handlers[`${cmdMerge}_${funHash}`])\n            handler = HandleMgr.handlers[`${cmdMerge}_${funHash}`];\n        if (handler == null) {\n            console.error(\"cmd handler is null,请检查是否回调异常\", CmdMgr.getCmd(cmdMerge), CmdMgr.getSubCmd(cmdMerge), funHash);\n        }\n        return handler;\n    }\n\n    //消息分发\n    public static packageHandler(cmdMerge: number, data: ExternalMessage) {\n        let handler = this.getHandler(cmdMerge, data.msgId);\n        if (handler)\n            handler(data);\n    }\n}\n"]}